(self.webpackChunknote=self.webpackChunknote||[]).push([[148],{81148:function(e,t,s){"use strict";s.r(t),s.d(t,{RequestAssignmentModule:function(){return v}});var i=s(61116),n=s(14969),r=s(8361),o=s(74847),u=s(35366),a=s(77744),l=s(89521),p=s(65916),c=s(28451),h=s(94217),g=s(49783),d=s(28302);function q(e,t){1&e&&(u.TgZ(0,"tr",10),u.TgZ(1,"th",11),u._UZ(2,"p-tableHeaderCheckbox"),u.qZA(),u.TgZ(3,"th"),u._uU(4),u.ALo(5,"translate"),u.qZA(),u.TgZ(6,"th"),u._uU(7),u.ALo(8,"translate"),u.qZA(),u.TgZ(9,"th"),u._uU(10),u.ALo(11,"translate"),u.qZA(),u.TgZ(12,"th"),u._uU(13),u.ALo(14,"translate"),u.qZA(),u.TgZ(15,"th"),u._uU(16),u.ALo(17,"translate"),u.qZA(),u.TgZ(18,"th"),u._uU(19),u.ALo(20,"translate"),u.qZA(),u.TgZ(21,"th"),u._uU(22),u.ALo(23,"translate"),u.qZA(),u.TgZ(24,"th"),u._uU(25),u.ALo(26,"translate"),u.qZA(),u.TgZ(27,"th"),u._uU(28),u.ALo(29,"translate"),u.qZA(),u.TgZ(30,"th"),u._uU(31,"SMS"),u.qZA(),u.qZA()),2&e&&(u.xp6(4),u.Oqu(u.lcZ(5,9,"requester")),u.xp6(3),u.Oqu(u.lcZ(8,11,"reason")),u.xp6(3),u.Oqu(u.lcZ(11,13,"goto")),u.xp6(3),u.Oqu(u.lcZ(14,15,"requestType")),u.xp6(3),u.Oqu(u.lcZ(17,17,"requestTime")),u.xp6(3),u.Oqu(u.lcZ(20,19,"durationTime")),u.xp6(3),u.Oqu(u.lcZ(23,21,"vehicle")),u.xp6(3),u.Oqu(u.lcZ(26,23,"driver")),u.xp6(3),u.Oqu(u.lcZ(29,25,"print")))}function Z(e,t){1&e&&(u.TgZ(0,"tr"),u.TgZ(1,"th",12),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.qZA()),2&e&&(u.xp6(2),u.hij(" ",u.lcZ(3,1,"noActiveAcceptedPoolRequest")," "))}function A(e,t){if(1&e&&(u.YNc(0,q,32,27,"tr",8),u.YNc(1,Z,4,3,"tr",9)),2&e){const e=u.oxw();u.Q6J("ngIf",0!=e.requestAssignment.length),u.xp6(1),u.Q6J("ngIf",0==e.requestAssignment.length)}}function m(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"date"),u.ALo(3,"date"),u.qZA()),2&e){const e=u.oxw().$implicit;u.xp6(1),u.AsE(" ",u.xi3(2,2,e.requester.starttime,"MMM,dd/yyyy :hh:mm:a")," To ",u.xi3(3,5,e.requester.endtime,"MMM,dd/yyyy:hh:mm:a")," ")}}function y(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"date"),u.ALo(3,"date"),u.qZA()),2&e){const e=u.oxw().$implicit;u.xp6(1),u.AsE(" ",u.xi3(2,2,e.requester.starttime,"MMM,dd/yyyy")," To ",u.xi3(3,5,e.requester.endtime,"MMM,dd/yyyy")," ")}}function f(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr",13),u.TgZ(1,"td"),u._UZ(2,"p-tableCheckbox",14),u.qZA(),u.TgZ(3,"td"),u._uU(4),u._UZ(5,"br"),u._uU(6),u._UZ(7,"br"),u.qZA(),u.TgZ(8,"td"),u._uU(9),u.qZA(),u.TgZ(10,"td"),u._uU(11),u.qZA(),u.TgZ(12,"td"),u._uU(13),u.qZA(),u.TgZ(14,"td"),u._uU(15),u.ALo(16,"date"),u.qZA(),u.TgZ(17,"td"),u.YNc(18,m,4,8,"span",9),u.YNc(19,y,4,8,"span",9),u.qZA(),u.TgZ(20,"td"),u._uU(21),u.qZA(),u.TgZ(22,"td"),u._uU(23),u._UZ(24,"br"),u._uU(25),u.qZA(),u.TgZ(26,"td"),u.TgZ(27,"button",15),u.NdJ("click",function(){u.CHM(e);const s=t.$implicit;return u.oxw().printData(s)}),u.qZA(),u.qZA(),u.TgZ(28,"td"),u.TgZ(29,"button",16),u.NdJ("click",function(){u.CHM(e);const s=t.$implicit;return u.oxw().SendSmsData(s)}),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=t.$implicit;u.xp6(2),u.Q6J("value",e),u.xp6(2),u.AsE("",e.requester.requester.firstName," ",e.requester.requester.lastName,""),u.xp6(2),u.hij(" ",e.requester.requester.phoneNumber," "),u.xp6(3),u.Oqu(e.requester.reason),u.xp6(2),u.Oqu(e.requester.goto),u.xp6(2),u.Oqu(e.requester.requesttype),u.xp6(2),u.hij(" ",u.xi3(16,13,e.requester.requesteddate,"MMM,dd/yyyy")," "),u.xp6(3),u.Q6J("ngIf","indoor"==e.requester.requesttype),u.xp6(1),u.Q6J("ngIf","field"==e.requester.requesttype),u.xp6(2),u.hij(" ",e.vehicles.platenumber," "),u.xp6(2),u.hij("",e.vehicles.driverName," "),u.xp6(2),u.hij(" ",e.vehicles.driverPhone," ")}}const T=function(){return{width:"50vw"}},x=[{path:"",component:(()=>{class e{constructor(e,t,s,i){this.poolService=e,this.sessionService=t,this.supportMethod=s,this.printService=i,this.iserror=!1,this.responseTitle="",this.responseDialog=!1,this.responseMesssage="",this.responseStyle="",this.SmsContent={requestID:"",phone:"",body:"",status:"0"}}ngOnInit(){this.user=this.sessionService.getItem("currentUser"),this.userRole=this.supportMethod.getUserRole(this.user),this.loading=!1,this.getRouteAssignment()}getRouteAssignment(){this.loading=!0,this.poolService.getRequestAssignment().then(e=>{this.requestAssignment="FleetManager"==this.userRole?e:e.filter(e=>e.requester.requester.id==this.user.user.id),this.loading=!1})}printSelectedData(){this.printService.generateMultiplePassengerTicketPDF(this.selecteData)}printData(e){this.printService.generateSinglePassengerTicketPDF(e)}SendSmsData(e){return t=this,void 0,i=function*(){let t={requestID:this.user.user.id,phone:"",body:"",status:"0"};this.SmsContent.requestID=this.user.user.id,this.SmsContent.phone=e.requester.requester.phoneNumber,this.SmsContent.body=`\u12e8\u1351\u120d \u1230\u122d\u126a\u1235 \u1325\u12eb\u1244\u12ce \u12c8\u12f0 ${e.requester.goto} \u1270\u1240\u1265\u1208\u1290\u12ce\u1273\u120d \u12e8\u1270\u1218\u12f0\u1260\u12c9 \u1230\u122d\u126a\u1235`,t.phone=e.vehicles.driverPhone,t.body=`\u12e8\u1351\u120d \u1230\u122d\u126a\u1235 \u12a5\u1295\u12f2\u1230\u1321\u120d\u1295\u1361\u1361 \u12e8\u1270\u1348\u1240\u12f0\u1208\u1275 \u1230\u122b\u1270\u129b ${e.requester.requester.firstName}`,yield this.poolService.RegisterSms(this.SmsContent).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseMesssage="Message is sent successfully",this.responseTitle="SUCCESS!!!",this.display=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s}),yield this.SendSmsFunction(t)},new((s=void 0)||(s=Promise))(function(e,n){function r(e){try{u(i.next(e))}catch(t){n(t)}}function o(e){try{u(i.throw(e))}catch(t){n(t)}}function u(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s(function(e){e(i)})).then(r,o)}u((i=i.apply(t,[])).next())});var t,s,i}SendSmsFunction(e){this.poolService.RegisterSms(e).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseDialog=!0,this.responseMesssage="Message is sent successfully",this.responseTitle="SUCCESS!!!",this.display=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s})}Okonclick(){this.responseDialog=!1,location.reload()}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(r.q),u.Y36(a.m),u.Y36(l.p),u.Y36(o.p))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-request-assignment"]],decls:15,vars:21,consts:[[3,"visible","modal","visibleChange"],["type","button","pButton","","icon","pi pi-check",3,"label","click"],[2,"text-align","right"],["pButton","","pRipple","","icon","pi pi-file-pdf","label","Print",1,"p-button-warning","p-mr-2",3,"disabled","click"],["styleClass","p-datatable-gridlines",3,"value","autoLayout","loading","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["class","header-row",4,"ngIf"],[4,"ngIf"],[1,"header-row"],[2,"width","3rem"],["colspan","11",2,"text-align","center","color","red"],[1,"body-row"],[3,"value"],["type","button","pButton","","pRipple","","icon","pi pi-file-pdf","pTooltip","Print","tooltipPosition","bottom",1,"p-button-warning","p-mr-2",3,"click"],["type","button","pButton","","label","Send",1,"p-button-success",3,"click"]],template:function(e,t){1&e&&(u.TgZ(0,"p-dialog",0),u.NdJ("visibleChange",function(e){return t.responseDialog=e}),u.TgZ(1,"p-header"),u.TgZ(2,"p"),u._uU(3),u.qZA(),u.qZA(),u.TgZ(4,"p"),u._uU(5),u.qZA(),u.TgZ(6,"p-footer"),u.TgZ(7,"button",1),u.NdJ("click",function(){return t.Okonclick()}),u.ALo(8,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(9,"div",2),u.TgZ(10,"button",3),u.NdJ("click",function(){return t.printSelectedData()}),u.qZA(),u.qZA(),u.TgZ(11,"p-table",4,5),u.NdJ("selectionChange",function(e){return t.selecteData=e}),u.YNc(13,A,2,2,"ng-template",6),u.YNc(14,f,30,16,"ng-template",7),u.qZA()),2&e&&(u.Akn(u.DdM(20,T)),u.Q6J("visible",t.responseDialog)("modal",!0),u.xp6(2),u.Tol(t.responseStyle),u.xp6(1),u.hij(" ",t.responseTitle," "),u.xp6(1),u.Tol(t.responseStyle),u.xp6(1),u.hij(" ",t.responseMesssage," "),u.xp6(2),u.s9C("label",u.lcZ(8,18,"ok")),u.xp6(3),u.Q6J("disabled",!t.selecteData||!t.selecteData.length),u.xp6(1),u.Q6J("value",t.requestAssignment)("autoLayout",!0)("loading",t.loading)("selection",t.selecteData))},directives:[p.V,c.h4,c.$_,h.Hq,g.iA,c.jx,i.O5,g.Mo,g.UA],pipes:[d.X$,i.uU],styles:[""]}),e})()}];let b=(()=>{class e{}return e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({factory:function(t){return new(t||e)},imports:[[n.Bz.forChild(x)],n.Bz]}),e})();var S=s(35119);let v=(()=>{class e{}return e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({factory:function(t){return new(t||e)},imports:[[i.ez,b,S.n]]}),e})()}}]);