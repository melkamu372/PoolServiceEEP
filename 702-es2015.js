(self.webpackChunknote=self.webpackChunknote||[]).push([[702],{97702:function(e,t,s){"use strict";s.r(t),s.d(t,{LineModule:function(){return j}});var i=s(61116),r=s(14969),o=s(11462),n=s(8361),l=s(25529),u=s(35366),a=s(28451),p=s(77744),c=s(89521),d=s(65916),g=s(94217),h=s(63505),Z=s(49783),f=s(14313),q=s(5590),m=s(13682),A=s(28302),x=function(e,t,s,i){return new(s||(s=Promise))(function(r,o){function n(e){try{u(i.next(e))}catch(t){o(t)}}function l(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(n,l)}u((i=i.apply(e,t||[])).next())})};function v(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",29),u.TgZ(1,"button",30),u.NdJ("click",function(){return u.CHM(e),u.oxw().register()}),u.ALo(2,"translate"),u.qZA(),u.qZA()}2&e&&(u.xp6(1),u.s9C("label",u.lcZ(2,1,"register")))}function y(e,t){1&e&&(u.TgZ(0,"th"),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"update")))}function T(e,t){1&e&&(u.TgZ(0,"th"),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.Oqu(u.lcZ(2,1,"assignVehicle")))}function b(e,t){1&e&&(u.TgZ(0,"th"),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.hij("",u.lcZ(2,1,"requestHomePoole")," "))}function w(e,t){if(1&e&&(u.TgZ(0,"tr",31),u.TgZ(1,"th"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"th"),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"th"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"th"),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.YNc(13,y,3,3,"th",32),u.YNc(14,T,3,3,"th",32),u.YNc(15,b,3,3,"th",32),u.qZA()),2&e){const e=u.oxw();u.xp6(2),u.Oqu(u.lcZ(3,7,"departure")),u.xp6(3),u.Oqu(u.lcZ(6,9,"way")),u.xp6(3),u.Oqu(u.lcZ(9,11,"destination")),u.xp6(3),u.Oqu(u.lcZ(12,13,"description")),u.xp6(2),u.Q6J("ngIf","FleetManager"==e.userRole||"PoolServiceAdministrator"==e.userRole),u.xp6(1),u.Q6J("ngIf","FleetManager"==e.userRole||"PoolServiceAdministrator"==e.userRole),u.xp6(1),u.Q6J("ngIf","PoolServiceAdministrator"!=e.userRole)}}function I(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"td"),u.TgZ(1,"button",34),u.NdJ("click",function(){u.CHM(e);const t=u.oxw().$implicit;return u.oxw().update(t)}),u.ALo(2,"translate"),u.qZA(),u.qZA()}2&e&&(u.xp6(1),u.s9C("label",u.lcZ(2,1,"update")))}function L(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"td"),u.TgZ(1,"p-button",35),u.NdJ("click",function(){u.CHM(e);const t=u.oxw().$implicit;return u.oxw().getSelectedRoute(t)}),u.ALo(2,"translate"),u.qZA(),u.qZA()}2&e&&(u.xp6(1),u.s9C("label",u.lcZ(2,1,"assign")))}function R(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"td"),u.TgZ(1,"p-button",35),u.NdJ("click",function(){u.CHM(e);const t=u.oxw().$implicit;return u.oxw().selectRoute(t)}),u.ALo(2,"translate"),u.qZA(),u.qZA()}2&e&&(u.xp6(1),u.s9C("label",u.lcZ(2,1,"requestService")))}function C(e,t){if(1&e&&(u.TgZ(0,"tr",33),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.TgZ(5,"td"),u._uU(6),u.qZA(),u.TgZ(7,"td"),u._uU(8),u.qZA(),u.YNc(9,I,3,3,"td",32),u.YNc(10,L,3,3,"td",32),u.YNc(11,R,3,3,"td",32),u.qZA()),2&e){const e=t.$implicit,s=u.oxw();u.xp6(2),u.hij("",e.departure," "),u.xp6(2),u.Oqu(e.way),u.xp6(2),u.Oqu(e.destination),u.xp6(2),u.Oqu(e.description),u.xp6(1),u.Q6J("ngIf","FleetManager"==s.userRole||"PoolServiceAdministrator"==s.userRole),u.xp6(1),u.Q6J("ngIf","FleetManager"==s.userRole||"PoolServiceAdministrator"==s.userRole),u.xp6(1),u.Q6J("ngIf","PoolServiceAdministrator"!=s.userRole)}}function S(e,t){1&e&&u._UZ(0,"p-message",36)}function M(e,t){1&e&&u._UZ(0,"p-message",37)}function J(e,t){1&e&&u._UZ(0,"p-message",40)}function N(e,t){if(1&e&&(u.TgZ(0,"div",38),u.YNc(1,J,1,0,"p-message",39),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngIf",e.userform.controls.destination.errors.required)}}function U(e,t){1&e&&(u.TgZ(0,"tr"),u.TgZ(1,"th"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"th"),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"th"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"th"),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.TgZ(13,"th"),u._uU(14),u.ALo(15,"translate"),u.qZA(),u.qZA()),2&e&&(u.xp6(2),u.hij("",u.lcZ(3,5,"name")," "),u.xp6(3),u.Oqu(u.lcZ(6,7,"model")),u.xp6(3),u.hij("",u.lcZ(9,9,"plateNumber")," "),u.xp6(3),u.Oqu(u.lcZ(12,11,"seatCapacity")),u.xp6(3),u.hij(" ",u.lcZ(15,13,"assign"),""))}function k(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"tr"),u.TgZ(1,"td"),u._uU(2),u.qZA(),u.TgZ(3,"td"),u._uU(4),u.qZA(),u.TgZ(5,"td"),u._uU(6),u.qZA(),u.TgZ(7,"td"),u._uU(8),u.qZA(),u.TgZ(9,"td"),u.TgZ(10,"button",41),u.NdJ("click",function(){u.CHM(e);const s=t.$implicit;return u.oxw().selectVehicle(s)}),u.qZA(),u.qZA(),u.qZA()}if(2&e){const e=t.$implicit;u.xp6(2),u.Oqu(e.name),u.xp6(2),u.Oqu(e.model),u.xp6(2),u.Oqu(e.platenumber),u.xp6(2),u.hij("",e.seatCapacity," ")}}function _(e,t){1&e&&u._UZ(0,"p-message",42)}function D(e,t){1&e&&u._UZ(0,"p-message",43)}const O=function(){return{width:"50vw"}},Q=function(){return{width:"30vw"}},B=[{path:"",component:(()=>{class e{constructor(e,t,s,i,r,o,n){this.poolService=e,this.fb=t,this.messageService=s,this.confirmationService=i,this.sessionService=r,this.supportMethod=o,this.customValidator=n,this.registerData=!1,this.updateData=!1,this.newLine={departure:"",way:"",destination:"",description:""},this.newHomePoolRequest={routeId:"",requesterId:"",managerId:"",requestedDate:new Date,status:!0,changeReason:"first Request"},this.newRoutBus={routeId:"",vehicleId:""},this.displayAccept=!1,this.submitted=!1,this.iserror=!1,this.responseTitle="",this.responseDialog=!1,this.responseMesssage="",this.responseStyle="",this.countNumBus=0}ngOnInit(){this.user=this.sessionService.getItem("currentUser"),this.loading=!1,this.getLine(),this.displayRequest=!1,this.userRole=this.supportMethod.getUserRole(this.user),this.userform=this.fb.group({departure:new o.NI("",o.kI.required),way:new o.NI("",o.kI.required),destination:new o.NI("",o.kI.required),description:new o.NI("",[o.kI.required])}),this.requestform=this.fb.group({userId:[null,[o.kI.required],this.customValidator.UserNameNotExistValidator.bind(this.customValidator)]})}getLine(){return x(this,void 0,void 0,function*(){this.loading=!0,yield this.poolService.getRoute().then(e=>{this.countNumBus=0,this.route=e.map(e=>e),this.loading=!1})})}getRouteBusAssignment(e){return x(this,void 0,void 0,function*(){yield this.poolService.getBusRouteAssignmentByRoute(e).then(e=>e.map(e=>e.bus.vehicleId))})}countBusByLine(e){return x(this,void 0,void 0,function*(){return yield this.poolService.countBusRouteAssignmentByroute(e).then(e=>e)})}register(){this.userform.reset(),this.display=!0,this.registerData=!0,this.updateData=!1,this.dialogTitle="registerRouteForm"}update(e){this.registerData=!1,this.updateData=!0,this.dialogTitle="updateRouteForm",this.display=!0,this.routeId=e.routeId,this.newLine.departure=e.departure,this.newLine.way=e.way,this.newLine.destination=e.destination,this.newLine.description=e.description}onClickRegisterLine(){this.registerData?this.poolService.RegisterLine(this.Lines).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseDialog=!0,this.responseTitle="SUCCESS!!!",this.responseMesssage="new information Registered successfully ",this.display=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s}):this.updateData&&this.poolService.updateRoute(this.Lines,this.routeId).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseDialog=!0,this.responseTitle="SUCCESS!!!",this.responseMesssage="Route information Updated successfully ",this.display=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s})}get Lines(){return this.newLine.departure=this.userform.controls.departure.value,this.newLine.destination=this.userform.controls.destination.value,this.newLine.way=this.userform.controls.way.value,this.newLine.description=this.userform.controls.description.value,this.newLine}Okonclick(){this.responseDialog=!1,location.reload()}onClickRequestLine(){this.newHomePoolRequest.managerId=this.user.user.id,this.newHomePoolRequest.requesterId=this.requestform.controls.userId.value,this.RegisterHomePoolRequest(this.newHomePoolRequest)}selectRoute(e){this.displayRequest=!0,this.dialogTitle="homePoolServiceRequestForm",this.newHomePoolRequest.routeId=e.routeId}RegisterHomePoolRequest(e){this.poolService.RegisterHomePoolRequest(e).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseDialog=!0,this.responseTitle="SUCCESS!!!",this.responseMesssage="Request Sent Successfully ",this.display=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s})}selectVehicle(e){this.displayAccept=!1,this.newRoutBus.routeId=this.routeId,this.newRoutBus.vehicleId=e.vehicleId,this.poolService.RegisterBusRouteAssignment(this.newRoutBus).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseDialog=!0,this.responseTitle="SUCCESS!!!",this.responseMesssage="Assigned successfully ",this.display=!1,this.submitted=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s;this.submitted=!1})}getVehicle(){this.poolService.getCar().then(e=>{this.vehicle=e.filter(e=>"home"==e.usedFor||"indoor"==e.usedFor),this.loading=!1})}getSelectedRoute(e){this.displayAccept=!0,this.routeId=e.routeId,this.getVehicle()}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(n.q),u.Y36(o.qu),u.Y36(a.ez),u.Y36(a.YP),u.Y36(p.m),u.Y36(c.p),u.Y36(l.q))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-line"]],decls:71,vars:94,consts:[[3,"visible","modal","visibleChange"],["type","button","pButton","","icon","pi pi-check",3,"label","click"],["rejectButtonStyleClass","p-button-text",3,"baseZIndex"],["style","text-align: right;",4,"ngIf"],["styleClass","p-datatable-gridlines",3,"value","autoLayout","loading"],["pTemplate","header","style","color: red;"],["pTemplate","body"],[3,"header","visible","transitionOptions","modal","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-formgrid","p-grid"],[1,"p-field","p-col-12","p-md-12"],["type","text","formControlName","departure","pInputText","","required","",3,"ngModel","ngModelChange"],["severity","error","text","Departure is required",4,"ngIf"],["type","text","formControlName","way","pInputText","","required","",3,"ngModel","ngModelChange"],["severity","error","text","Departure  way is required",4,"ngIf"],["type","text","formControlName","destination","pInputText","","required","",3,"ngModel","ngModelChange"],["class","p-col-12",4,"ngIf"],[1,"p-field","p-col-12"],["for","address"],["type","text","rows","4","formControlName","description","pInputTextarea","","required","",3,"ngModel","ngModelChange"],[1,"p-field","p-col-6"],["pButton","","type","button",1,"ui-button-raised",3,"label","disabled","click"],["pButton","","type","reset",1,"ui-button-raised",3,"label"],[3,"header","visible","modal","visibleChange"],[3,"value","paginator","rows","responsive"],["pTemplate","header"],["type","text","formControlName","userId","pInputText","","required",""],["severity","error","text","Requester Id is required",4,"ngIf"],["severity","error","text","Requester Id is not exists if not registered please first register",4,"ngIf"],[2,"text-align","right"],["pButton","","type","button",1,"p-button-success",3,"label","click"],[1,"header-row"],[4,"ngIf"],[1,"body-row"],["pButton","","type","button",3,"label","click"],["icon","pi pi-check","styleClass","p-mr-2",3,"label","click"],["severity","error","text","Departure is required"],["severity","error","text","Departure  way is required"],[1,"p-col-12"],["severity","error","text","destination is required",4,"ngIf"],["severity","error","text","destination is required"],["type","button","pButton","","icon","pi pi-check",3,"click"],["severity","error","text","Requester Id is required"],["severity","error","text","Requester Id is not exists if not registered please first register"]],template:function(e,t){1&e&&(u.TgZ(0,"p-dialog",0),u.NdJ("visibleChange",function(e){return t.responseDialog=e}),u.TgZ(1,"p-header"),u.TgZ(2,"p"),u._uU(3),u.qZA(),u.qZA(),u.TgZ(4,"p"),u._uU(5),u.qZA(),u.TgZ(6,"p-footer"),u.TgZ(7,"button",1),u.NdJ("click",function(){return t.Okonclick()}),u.ALo(8,"translate"),u.qZA(),u.qZA(),u.qZA(),u._UZ(9,"p-confirmDialog",2),u.YNc(10,v,3,3,"div",3),u.TgZ(11,"p-table",4),u.YNc(12,w,16,15,"ng-template",5),u.YNc(13,C,12,7,"ng-template",6),u.qZA(),u.TgZ(14,"p-dialog",7),u.NdJ("visibleChange",function(e){return t.display=e}),u.ALo(15,"translate"),u.TgZ(16,"form",8),u.NdJ("ngSubmit",function(){return t.onClickRegisterLine()}),u.TgZ(17,"div",9),u.TgZ(18,"div",10),u.TgZ(19,"label"),u._uU(20),u.ALo(21,"translate"),u.qZA(),u.TgZ(22,"input",11),u.NdJ("ngModelChange",function(e){return t.newLine.departure=e}),u.qZA(),u.YNc(23,S,1,0,"p-message",12),u.qZA(),u.TgZ(24,"div",10),u.TgZ(25,"label"),u._uU(26),u.ALo(27,"translate"),u.qZA(),u.TgZ(28,"input",13),u.NdJ("ngModelChange",function(e){return t.newLine.way=e}),u.qZA(),u.YNc(29,M,1,0,"p-message",14),u.qZA(),u.TgZ(30,"div",10),u.TgZ(31,"label"),u._uU(32),u.ALo(33,"translate"),u.qZA(),u.TgZ(34,"input",15),u.NdJ("ngModelChange",function(e){return t.newLine.destination=e}),u.qZA(),u.qZA(),u.YNc(35,N,2,1,"div",16),u.TgZ(36,"div",17),u.TgZ(37,"label",18),u._uU(38),u.ALo(39,"translate"),u.qZA(),u.TgZ(40,"textarea",19),u.NdJ("ngModelChange",function(e){return t.newLine.description=e}),u.qZA(),u.qZA(),u.qZA(),u.TgZ(41,"div",9),u.TgZ(42,"div",20),u.TgZ(43,"button",21),u.NdJ("click",function(){return t.onClickRegisterLine()}),u.ALo(44,"translate"),u.qZA(),u.qZA(),u.TgZ(45,"div",20),u._UZ(46,"button",22),u.ALo(47,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(48,"p-dialog",23),u.NdJ("visibleChange",function(e){return t.displayAccept=e}),u.ALo(49,"translate"),u.TgZ(50,"p-table",24),u.YNc(51,U,16,15,"ng-template",25),u.YNc(52,k,11,4,"ng-template",6),u.qZA(),u.qZA(),u.TgZ(53,"p-dialog",7),u.NdJ("visibleChange",function(e){return t.displayRequest=e}),u.ALo(54,"translate"),u.TgZ(55,"form",8),u.NdJ("ngSubmit",function(){return t.onClickRequestLine()}),u.TgZ(56,"div",9),u.TgZ(57,"div",10),u.TgZ(58,"label"),u._uU(59),u.ALo(60,"translate"),u.qZA(),u._UZ(61,"input",26),u.YNc(62,_,1,0,"p-message",27),u.YNc(63,D,1,0,"p-message",28),u.qZA(),u.qZA(),u.TgZ(64,"div",9),u.TgZ(65,"div",20),u.TgZ(66,"button",21),u.NdJ("click",function(){return t.onClickRequestLine()}),u.ALo(67,"translate"),u.qZA(),u.qZA(),u.TgZ(68,"div",20),u._UZ(69,"button",22),u.ALo(70,"translate"),u.qZA(),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Akn(u.DdM(89,O)),u.Q6J("visible",t.responseDialog)("modal",!0),u.xp6(2),u.Tol(t.responseStyle),u.xp6(1),u.hij(" ",t.responseTitle," "),u.xp6(1),u.Tol(t.responseStyle),u.xp6(1),u.hij(" ",t.responseMesssage," "),u.xp6(2),u.s9C("label",u.lcZ(8,63,"ok")),u.xp6(2),u.Akn(u.DdM(90,O)),u.Q6J("baseZIndex",1e4),u.xp6(1),u.Q6J("ngIf","FleetManager"==t.userRole||"PoolServiceAdministrator"==t.userRole),u.xp6(1),u.Q6J("value",t.route)("autoLayout",!0)("loading",t.loading),u.xp6(3),u.Akn(u.DdM(91,Q)),u.s9C("header",u.lcZ(15,65,t.dialogTitle)),u.Q6J("visible",t.display)("transitionOptions","0ms")("modal",!0),u.xp6(2),u.Q6J("formGroup",t.userform),u.xp6(4),u.Oqu(u.lcZ(21,67,"departure")),u.xp6(2),u.Q6J("ngModel",t.newLine.departure),u.xp6(1),u.Q6J("ngIf",!t.userform.controls.departure.valid&&t.userform.controls.departure.dirty),u.xp6(3),u.Oqu(u.lcZ(27,69,"way")),u.xp6(2),u.Q6J("ngModel",t.newLine.way),u.xp6(1),u.Q6J("ngIf",!t.userform.controls.way.valid&&t.userform.controls.way.dirty),u.xp6(3),u.Oqu(u.lcZ(33,71,"destination")),u.xp6(2),u.Q6J("ngModel",t.newLine.destination),u.xp6(1),u.Q6J("ngIf",t.userform.controls.destination.errors&&t.userform.controls.destination.dirty&&t.userform.controls.destination.touched),u.xp6(3),u.Oqu(u.lcZ(39,73,"description")),u.xp6(2),u.Q6J("ngModel",t.newLine.description),u.xp6(3),u.s9C("label",u.lcZ(44,75,"save")),u.Q6J("disabled",!t.userform.valid),u.xp6(3),u.s9C("label",u.lcZ(47,77,"reset")),u.xp6(2),u.Akn(u.DdM(92,O)),u.s9C("header",u.lcZ(49,79,"selectVehicleandAssign")),u.Q6J("visible",t.displayAccept)("modal",!0),u.xp6(2),u.Q6J("value",t.vehicle)("paginator",!0)("rows",5)("responsive",!0),u.xp6(3),u.Akn(u.DdM(93,Q)),u.s9C("header",u.lcZ(54,81,t.dialogTitle)),u.Q6J("visible",t.displayRequest)("transitionOptions","0ms")("modal",!0),u.xp6(2),u.Q6J("formGroup",t.requestform),u.xp6(4),u.Oqu(u.lcZ(60,83,"requesterId")),u.xp6(3),u.Q6J("ngIf",t.requestform.controls.userId.touched&&(null==t.requestform.controls.userId.errors?null:t.requestform.controls.userId.errors.required)),u.xp6(1),u.Q6J("ngIf",t.requestform.controls.userId.touched&&(null==t.requestform.controls.userId.errors?null:t.requestform.controls.userId.errors.userNameNotAvailable)),u.xp6(3),u.s9C("label",u.lcZ(67,85,"request")),u.Q6J("disabled",!t.requestform.valid),u.xp6(3),u.s9C("label",u.lcZ(70,87,"reset")))},directives:[d.V,a.h4,a.$_,g.Hq,h.Q,i.O5,Z.iA,a.jx,o.vK,o.JL,o.sg,o.Fj,o.JJ,o.u,f.o,o.Q7,q.g,g.zx,m.q],pipes:[A.X$],styles:[""]}),e})()}];let Y=(()=>{class e{}return e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({factory:function(t){return new(t||e)},imports:[[r.Bz.forChild(B)],r.Bz]}),e})();var P=s(35119);let j=(()=>{class e{}return e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({factory:function(t){return new(t||e)},imports:[[i.ez,Y,P.n]]}),e})()}}]);